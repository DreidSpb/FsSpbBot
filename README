Code is bad, need refactoring and commenting.
But working :)
